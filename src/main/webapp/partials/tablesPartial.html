</br>
</br>
<div class="col-sm-1"></div>
<div class="col-sm-10">
	<div>
		<div class="form-inline">
			<div class="form-group">
				<label for="sel1">Tabele:</label> <select style="width: auto;"
					class="form-control" ng-model="selectedTable" id="sel1">
					<option ng-repeat="table in allTableNames">{{table}}</option>
				</select>
			</div>
			<button type="button" class="btn btn-primary" ng-click="showTable()">Prikazi tabelu</button>
		</div>
	</div>
	<br/><br/>
	<div ng-show="filteredNextTable">
		<div class="form-inline">
			<button ng-click="generateCreateFormNext()" class="btn btn-success centered">
				<span class="glyphicon glyphicon-plus"></span> Dodaj novi red
			</button>
			<button ng-click="removeTableNext()" class="btn btn-primary centered">
				Ukloni tabelu
			</button>
		</div>
		<table class="table table-hover table-bordered">
			  <thead>
			    <tr>
			      <th class="centered" ng-repeat="field in filteredNextTable.fields">{{field.name}}</th>
						<th class="centered">Operacije</th>
			    </tr>
			  </thead>
			  <tbody class="centered">
			    <tr ng-repeat="row in filteredNextTable.rows track by $index">
			      <td ng-repeat="data in row.fields track by $index">{{row.fields[filteredNextTable.fields[$index].name]}}</td>
						<td>
							<button ng-click="generateEditFormNext($index, row, $event)" class="btn btn-warning">
		          	<span class="glyphicon glyphicon-edit"></span> Uredi
							</button>
							<button ng-click="deleteRowNext($index, row, $event)" class="btn btn-danger">
		          	<span class="glyphicon glyphicon-trash"></span> Obriši
							</button>
							<button ng-click="downloadPDF(row, $event)" class="btn btn-primary" ng-if="filteredNextTable.tableName==='Faktura'">
	          		<span class="glyphicon glyphicon-save"></span> PDF</button>
	        		<button ng-click="downloadXML(row, $event)"  class="btn btn-primary" ng-if="filteredNextTable.tableName==='Faktura'">
	          		<span class="glyphicon glyphicon-save"></span> XML</button>
						</td>
			    </tr>
			  </tbody>
		</table>
	</div>
	<br/><br/>
	<div ng-show="requestedTable">
		<div class="form-inline">
			<button ng-click="generateCreateForm()" class="btn btn-success centered">
				<span class="glyphicon glyphicon-plus"></span> Dodaj novi red
			</button>
			<button ng-if="requestedTable.children" ng-click="showNextTableSelection()" class="btn btn-primary centered">
				<span class="glyphicon glyphicon-arrow-right"></span> Next mehanizam
			</button>
			<div ng-show="showNextSelect">
				<div class="form-group">
					<label for="sel2">Tabele za next:</label> <select style="width: auto;"
						class="form-control" ng-model="nextTableTop" id="sel2">
						<option ng-repeat="table in requestedTable.children">{{table}}</option>
					</select>
				</div>
				<input type = "text" ng-model="idNextTableTop" class="form-control"
					placeholder="Unesite id reda za next"/>
				<button type="button" class="btn btn-primary" ng-click="openNextTableTop(requestedTable.tableName, nextTableTop, idNextTableTop)">Prikazi next tabelu</button>
			</div>
		</div>
		<table class="table table-hover table-bordered">
		  <thead>
		    <tr>
		      <th class="centered" ng-repeat="field in requestedTable.fields">{{field.name}}</th>
					<th class="centered">Operacije</th>
		    </tr>
		  </thead>
		  <tbody class="centered">
		    <tr ng-click="openDocument(row.fields.id)" ng-repeat="row in requestedTable.rows track by $index">
		      <td ng-repeat="data in row.fields track by $index">{{row.fields[requestedTable.fields[$index].name]}}</td>
					<td>
						<button ng-click="generateEditForm($index, row, $event)" class="btn btn-warning">
	          	<span class="glyphicon glyphicon-edit"></span> Uredi
						</button>
						<button ng-click="deleteRow($index, row, $event)" class="btn btn-danger">
	          	<span class="glyphicon glyphicon-trash"></span> Obriši
						</button>
						<button ng-click="downloadPDF(row, $event)" class="btn btn-primary" ng-if="requestedTable.tableName==='Faktura'">
          		<span class="glyphicon glyphicon-save"></span> PDF</button>
        		<button ng-click="downloadXML(row, $event)"  class="btn btn-primary" ng-if="requestedTable.tableName==='Faktura'">
          		<span class="glyphicon glyphicon-save"></span> XML</button>
					</td>
		    </tr>
		  </tbody>
		</table>
		<br/><br/>

		<div ng-if="requestedTable.documentPattern && requestedTable.documentChildName && documentChild">
			<button ng-click="generateCreateSubForm()" class="btn btn-success centered" ng-if="documentChild.fields.length">
				<span class="glyphicon glyphicon-plus"></span> Dodaj novu stavku
			</button>
			<table class="table table-hover table-bordered">
			  <thead>
			    <tr>
			      <th class="centered" ng-repeat="field in documentChild.fields">{{field.name}}</th>
						<th class="centered" ng-if="documentChild.fields.length">Operacije</th>
			    </tr>
			  </thead>
			  <tbody class="centered">
			    <tr ng-repeat="row in documentChild.rows">
			      <td ng-repeat="data in row.fields track by $index">{{row.fields[documentChild.fields[$index].name]}}</td>
						<td ng-if="documentChild.fields.length">
							<button ng-click="generateEditSubForm($index, row, $event)" class="btn btn-warning">
		          	<span class="glyphicon glyphicon-edit"></span> Uredi
							</button>
							<button ng-click="deleteSubRow($index, row, $event)" class="btn btn-danger">
		          	<span class="glyphicon glyphicon-trash"></span> Obriši
							</button>
						</td>
			    </tr>
			  </tbody>
			</table>
		</div>

		<br/><br/>
		<div ng-if="currentRow">
			<h2> {{formText}} </h2><br/>
			<div style="height: 30pt;" ng-repeat="field in currentTable.fields" ng-if="field.name!=='id' || operation!=='create' && operation!=='sub_create' && operation!=='next_create'">
				<div class="form-inline">
					<div class="form-group" style="width: 150px; float:left; text-align: left;">
						<label>{{field.name}}</label>
					</div>
				</div>
				<div class="form-inline">
					<div style="width: 200px; float:left;">
						<input type = "text" ng-readonly="field.name==='id' || field.fk"
							ng-model="currentRow.fields[field.name]" class="form-control"
							placeholder="{{field.type==='date' && 'mm/dd/yyyy ili mm-dd-yyyy' || ''}}"/>
					</div>
				</div>
				<div class="form-inline">
					<div class="form-group" style="width: 100px; float:left;">
						<button ng-click="foreignKey(field)" class="btn btn-info" ng-if="field.fk">
							<span class="glyphicon glyphicon-option-horizontal"></span>
						</button>
					</div>
				</div>
			</div>
			<br/>
			<button ng-click="submitForm()" class="btn btn-success">
				<span class="glyphicon glyphicon-ok"></span> {{formText}}
			</button>
			<button ng-click="closeForm()" class="btn btn-danger">
				<span class="glyphicon glyphicon-remove"></span> Poništi
			</button>
			<br/><br/><br/>
		</div>
	</div>
	
		
	<div ng-if="foreignKeyClicked" class="centered">
		<label>Izaberite tabelu:</label>
		<table class="table table-hover table-bordered">
		  <thead>
		    <tr>
		      <th class="centered" ng-repeat="field in foreignTable.fields">{{field.name}}</th>
		    </tr>
		  </thead>
		  <tbody class="centered">
		    <tr ng-click="openDocumentForeignKey(row.fields.id)" ng-repeat="row in foreignTable.rows track by $index">
		      <td ng-repeat="data in row.fields track by $index">{{row.fields[foreignTable.fields[$index].name]}}</td>
		    </tr>
		  </tbody>
		</table>
		<br/><br/>
		<button ng-click="addForeignKey()" class="btn btn-success">
				<span class="glyphicon glyphicon-ok"></span> Dodaj tabelu
		</button>
		<button ng-click="closeForeignKeyForm()" class="btn btn-danger">
			<span class="glyphicon glyphicon-remove"></span> Poništi
		</button><br/><br/>
		

		<div ng-if="foreignTable.documentPattern && documentForeignChild && selectedForeignKey">
			<table class="table table-hover table-bordered">
			  <thead>
			    <tr>
			      <th class="centered" ng-repeat="field in documentForeignChild.fields">{{field.name}}</th>
			    </tr>
			  </thead>
			  <tbody class="centered">
			    <tr ng-repeat="row in documentForeignChild.rows">
			      <td ng-repeat="data in row.fields track by $index">{{row.fields[documentForeignChild.fields[$index].name]}}</td>
			    </tr>
			  </tbody>
			</table>
		</div>
	</div>
	
</div>
